# 常见Web攻击
## xss攻击
跨站脚本攻击，允许攻击者将恶意代码植入其它用户使用的页面中。[参考文档](https://tech.meituan.com/2018/09/27/fe-security.html)

根据攻击来源，xss攻击可以分为以下三类:
- 储存型
  - 攻击者将恶意代码提交到目标网站的数据库中
  - 用户打开目标网站，网站服务端将恶意代码从数据库取出，拼接在HTML中返回浏览器
  - 用户浏览器接受响应后解析执行，其中的恶意代码也被执行
  - 恶意代码窃取用户数据并发送给攻击者的网站，或者冒充用户行为，调用目标网站接口执行攻击者指定的操作

- 反射型
  - 攻击者构造出特殊的URL，包含恶意代码
  - 用户打开带有恶意代码的URL时，网站服务端会获取URL上的恶意代码，拼接在HTML中返回给浏览器
  - 用户浏览器接受响应后解析执行，其中的恶意代码也被执行
  - 恶意代码窃取用户数据并发送给攻击者的网站，或者冒充用户行为，调用目标网站接口执行攻击者指定的操作

- DOM型
  - 攻击者构造出特殊的URL，包含恶意代码
  - 用户打开带有恶意代码的URL
  - 用户浏览器接受响应后解析执行，前端js取出URL中的恶意代码并执行
  - 恶意代码窃取用户数据并发送给攻击者的网站，或者冒充用户行为，调用目标网站接口执行攻击者指定的操作

预防策略
- 对输出到HTML中的内容进行转义
- 设置CSP
- 设置`Cookie HttpOnly`属性

## CSRF攻击
跨域请求伪造攻击，攻击者诱导受害者进入第三方网站，在第三方网站中，像被攻击网站发起跨站请求。[参考文档](https://tech.meituan.com/2018/10/11/fe-security-csrf.html)

攻击流程
  - 受害者登录a.com，并保留了登录凭证
  - 攻击者引诱受害者访问b.com
  - b.com向a.com发起请求，浏览器默认会携带a.com的cookie
  - a.com接收到请求后，误以为是受害者自己发起的请求，执行了攻击者的攻击操作
  - 攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让a.com执行了攻击操作

预防方案
  - 阻止不明外域的访问
    - 同源检测

      根据`Origin`和`Refer`这两个请求头进行判断

    - `SameSite Cookie`

  - 提交时要求附加本域才能获取的信息
    - CSRF Token
    - 双重Cookie验证